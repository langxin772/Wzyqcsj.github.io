<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Python在人工智能中的应用：从入门到实战 | AI探索者的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Python在人工智能中的应用：从入门到实战Python已经成为人工智能和数据科学领域的首选编程语言。其简洁的语法、丰富的库生态系统和强大的社区支持，使得Python成为AI开发者的最佳选择。本文将全面介绍Python在AI中的应用。 为什么选择Python？1. 语法简洁易学123456789# Python的简洁语法def fibonacci(n):    if n &lt;&#x3D; 1:">
<meta property="og:type" content="article">
<meta property="og:title" content="Python在人工智能中的应用：从入门到实战">
<meta property="og:url" content="https://langxin772.github.io/2025/01/03/python-for-ai/index.html">
<meta property="og:site_name" content="AI探索者的博客">
<meta property="og:description" content="Python在人工智能中的应用：从入门到实战Python已经成为人工智能和数据科学领域的首选编程语言。其简洁的语法、丰富的库生态系统和强大的社区支持，使得Python成为AI开发者的最佳选择。本文将全面介绍Python在AI中的应用。 为什么选择Python？1. 语法简洁易学123456789# Python的简洁语法def fibonacci(n):    if n &lt;&#x3D; 1:">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-01-03T01:15:00.000Z">
<meta property="article:modified_time" content="2025-06-11T10:15:53.686Z">
<meta property="article:author" content="AI学习者">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="数据科学">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="AI工具">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/Wzyqcsj.github.io/atom.xml" title="AI探索者的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/Wzyqcsj.github.io/favicon.png">
  
  
  
<link rel="stylesheet" href="/Wzyqcsj.github.io/css/style.css">

  
    
<link rel="stylesheet" href="/Wzyqcsj.github.io/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/Wzyqcsj.github.io/" id="logo">AI探索者的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/Wzyqcsj.github.io/" id="subtitle">人工智能学习与实践分享</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/Wzyqcsj.github.io/">Home</a>
        
          <a class="main-nav-link" href="/Wzyqcsj.github.io/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/Wzyqcsj.github.io/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://langxin772.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-python-for-ai" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Wzyqcsj.github.io/2025/01/03/python-for-ai/" class="article-date">
  <time class="dt-published" datetime="2025-01-03T01:15:00.000Z" itemprop="datePublished">2025-01-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Wzyqcsj.github.io/categories/%E7%BC%96%E7%A8%8B%E6%95%99%E7%A8%8B/">编程教程</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Python在人工智能中的应用：从入门到实战
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Python在人工智能中的应用：从入门到实战"><a href="#Python在人工智能中的应用：从入门到实战" class="headerlink" title="Python在人工智能中的应用：从入门到实战"></a>Python在人工智能中的应用：从入门到实战</h1><p>Python已经成为人工智能和数据科学领域的首选编程语言。其简洁的语法、丰富的库生态系统和强大的社区支持，使得Python成为AI开发者的最佳选择。本文将全面介绍Python在AI中的应用。</p>
<h2 id="为什么选择Python？"><a href="#为什么选择Python？" class="headerlink" title="为什么选择Python？"></a>为什么选择Python？</h2><h3 id="1-语法简洁易学"><a href="#1-语法简洁易学" class="headerlink" title="1. 语法简洁易学"></a>1. 语法简洁易学</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python的简洁语法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> fibonacci(n-<span class="number">1</span>) + fibonacci(n-<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表推导式</span></span><br><span class="line">squares = [x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="built_in">print</span>(squares)  <span class="comment"># [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-丰富的AI库生态"><a href="#2-丰富的AI库生态" class="headerlink" title="2. 丰富的AI库生态"></a>2. 丰富的AI库生态</h3><ul>
<li><strong>数据处理</strong>：NumPy, Pandas</li>
<li><strong>机器学习</strong>：Scikit-learn, XGBoost</li>
<li><strong>深度学习</strong>：TensorFlow, PyTorch, Keras</li>
<li><strong>数据可视化</strong>：Matplotlib, Seaborn, Plotly</li>
<li><strong>自然语言处理</strong>：NLTK, spaCy, Transformers</li>
</ul>
<h3 id="3-强大的社区支持"><a href="#3-强大的社区支持" class="headerlink" title="3. 强大的社区支持"></a>3. 强大的社区支持</h3><ul>
<li>活跃的开源社区</li>
<li>丰富的学习资源</li>
<li>快速的问题解决</li>
</ul>
<h2 id="Python-AI开发环境搭建"><a href="#Python-AI开发环境搭建" class="headerlink" title="Python AI开发环境搭建"></a>Python AI开发环境搭建</h2><h3 id="1-安装Python和包管理器"><a href="#1-安装Python和包管理器" class="headerlink" title="1. 安装Python和包管理器"></a>1. 安装Python和包管理器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用Anaconda（推荐）</span></span><br><span class="line"><span class="comment"># 下载并安装Anaconda</span></span><br><span class="line"><span class="comment"># https://www.anaconda.com/products/distribution</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">conda create -n ai_env python=3.9</span><br><span class="line">conda activate ai_env</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用pip和venv</span></span><br><span class="line">python -m venv ai_env</span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line">ai_env\Scripts\activate</span><br><span class="line"><span class="comment"># macOS/Linux</span></span><br><span class="line"><span class="built_in">source</span> ai_env/bin/activate</span><br></pre></td></tr></table></figure>

<h3 id="2-安装核心AI库"><a href="#2-安装核心AI库" class="headerlink" title="2. 安装核心AI库"></a>2. 安装核心AI库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础数据科学库</span></span><br><span class="line">conda install numpy pandas matplotlib seaborn jupyter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 机器学习库</span></span><br><span class="line">conda install scikit-learn</span><br><span class="line">pip install xgboost lightgbm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 深度学习库</span></span><br><span class="line">pip install tensorflow</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">pip install torch torchvision torchaudio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自然语言处理</span></span><br><span class="line">pip install nltk spacy transformers</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算机视觉</span></span><br><span class="line">pip install opencv-python pillow</span><br></pre></td></tr></table></figure>

<h3 id="3-Jupyter-Notebook配置"><a href="#3-Jupyter-Notebook配置" class="headerlink" title="3. Jupyter Notebook配置"></a>3. Jupyter Notebook配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装Jupyter扩展</span></span><br><span class="line">conda install -c conda-forge jupyterlab</span><br><span class="line">pip install jupyterlab-extensions</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动Jupyter Lab</span></span><br><span class="line">jupyter lab</span><br></pre></td></tr></table></figure>

<h2 id="核心AI库详解"><a href="#核心AI库详解" class="headerlink" title="核心AI库详解"></a>核心AI库详解</h2><h3 id="1-NumPy-数值计算基础"><a href="#1-NumPy-数值计算基础" class="headerlink" title="1. NumPy - 数值计算基础"></a>1. NumPy - 数值计算基础</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数组</span></span><br><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">matrix = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组操作</span></span><br><span class="line"><span class="built_in">print</span>(arr.shape)  <span class="comment"># (5,)</span></span><br><span class="line"><span class="built_in">print</span>(matrix.shape)  <span class="comment"># (2, 2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数学运算</span></span><br><span class="line">result = np.dot(matrix, matrix)  <span class="comment"># 矩阵乘法</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># [[7 10]</span></span><br><span class="line"><span class="comment">#  [15 22]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计函数</span></span><br><span class="line">data = np.random.randn(<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;均值: <span class="subst">&#123;np.mean(data):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;标准差: <span class="subst">&#123;np.std(data):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 广播机制</span></span><br><span class="line">a = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">b = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>]])</span><br><span class="line">result = a + b  <span class="comment"># 自动广播</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># [[2 3 4]</span></span><br><span class="line"><span class="comment">#  [3 4 5]</span></span><br><span class="line"><span class="comment">#  [4 5 6]]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Pandas-数据处理神器"><a href="#2-Pandas-数据处理神器" class="headerlink" title="2. Pandas - 数据处理神器"></a>2. Pandas - 数据处理神器</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建DataFrame</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Diana&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">28</span>],</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">70000</span>, <span class="number">55000</span>],</span><br><span class="line">    <span class="string">&#x27;department&#x27;</span>: [<span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;Finance&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;HR&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本信息</span></span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="built_in">print</span>(df.info())</span><br><span class="line"><span class="built_in">print</span>(df.describe())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据筛选</span></span><br><span class="line">it_employees = df[df[<span class="string">&#x27;department&#x27;</span>] == <span class="string">&#x27;IT&#x27;</span>]</span><br><span class="line">high_salary = df[df[<span class="string">&#x27;salary&#x27;</span>] &gt; <span class="number">55000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组统计</span></span><br><span class="line">dept_stats = df.groupby(<span class="string">&#x27;department&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;mean&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(dept_stats)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据清洗</span></span><br><span class="line"><span class="comment"># 处理缺失值</span></span><br><span class="line">df_with_na = df.copy()</span><br><span class="line">df_with_na.loc[<span class="number">0</span>, <span class="string">&#x27;salary&#x27;</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="comment"># 填充缺失值</span></span><br><span class="line">df_filled = df_with_na.fillna(df_with_na[<span class="string">&#x27;salary&#x27;</span>].mean())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除重复值</span></span><br><span class="line">df_unique = df.drop_duplicates()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据类型转换</span></span><br><span class="line">df[<span class="string">&#x27;age&#x27;</span>] = df[<span class="string">&#x27;age&#x27;</span>].astype(<span class="string">&#x27;float64&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据透视表</span></span><br><span class="line">pivot_table = df.pivot_table(</span><br><span class="line">    values=<span class="string">&#x27;salary&#x27;</span>,</span><br><span class="line">    index=<span class="string">&#x27;department&#x27;</span>,</span><br><span class="line">    aggfunc=[<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(pivot_table)</span><br></pre></td></tr></table></figure>

<h3 id="3-Matplotlib-Seaborn-数据可视化"><a href="#3-Matplotlib-Seaborn-数据可视化" class="headerlink" title="3. Matplotlib &amp; Seaborn - 数据可视化"></a>3. Matplotlib &amp; Seaborn - 数据可视化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置中文字体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成示例数据</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;x&#x27;</span>: np.random.randn(<span class="number">100</span>),</span><br><span class="line">    <span class="string">&#x27;y&#x27;</span>: np.random.randn(<span class="number">100</span>),</span><br><span class="line">    <span class="string">&#x27;category&#x27;</span>: np.random.choice([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>], <span class="number">100</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建子图</span></span><br><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">12</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 散点图</span></span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].scatter(data[<span class="string">&#x27;x&#x27;</span>], data[<span class="string">&#x27;y&#x27;</span>], c=data[<span class="string">&#x27;category&#x27;</span>].astype(<span class="string">&#x27;category&#x27;</span>).cat.codes)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].set_title(<span class="string">&#x27;散点图&#x27;</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].set_xlabel(<span class="string">&#x27;X轴&#x27;</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">0</span>].set_ylabel(<span class="string">&#x27;Y轴&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直方图</span></span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].hist(data[<span class="string">&#x27;x&#x27;</span>], bins=<span class="number">20</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].set_title(<span class="string">&#x27;直方图&#x27;</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].set_xlabel(<span class="string">&#x27;数值&#x27;</span>)</span><br><span class="line">axes[<span class="number">0</span>, <span class="number">1</span>].set_ylabel(<span class="string">&#x27;频次&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 箱线图</span></span><br><span class="line">sns.boxplot(data=data, x=<span class="string">&#x27;category&#x27;</span>, y=<span class="string">&#x27;x&#x27;</span>, ax=axes[<span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">axes[<span class="number">1</span>, <span class="number">0</span>].set_title(<span class="string">&#x27;箱线图&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 热力图</span></span><br><span class="line">corr_matrix = data[[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]].corr()</span><br><span class="line">sns.heatmap(corr_matrix, annot=<span class="literal">True</span>, ax=axes[<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">axes[<span class="number">1</span>, <span class="number">1</span>].set_title(<span class="string">&#x27;相关性热力图&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 高级可视化</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">sns.pairplot(data, hue=<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h3 id="4-Scikit-learn-机器学习工具包"><a href="#4-Scikit-learn-机器学习工具包" class="headerlink" title="4. Scikit-learn - 机器学习工具包"></a>4. Scikit-learn - 机器学习工具包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris, make_classification</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_val_score, GridSearchCV</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, LabelEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载数据</span></span><br><span class="line">iris = load_iris()</span><br><span class="line">X, y = iris.data, iris.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据分割</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>, stratify=y</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据标准化</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_scaled = scaler.fit_transform(X_train)</span><br><span class="line">X_test_scaled = scaler.transform(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型训练和比较</span></span><br><span class="line">models = &#123;</span><br><span class="line">    <span class="string">&#x27;Logistic Regression&#x27;</span>: LogisticRegression(random_state=<span class="number">42</span>),</span><br><span class="line">    <span class="string">&#x27;Random Forest&#x27;</span>: RandomForestClassifier(random_state=<span class="number">42</span>),</span><br><span class="line">    <span class="string">&#x27;SVM&#x27;</span>: SVC(random_state=<span class="number">42</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">results = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    <span class="comment"># 交叉验证</span></span><br><span class="line">    cv_scores = cross_val_score(model, X_train_scaled, y_train, cv=<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 训练模型</span></span><br><span class="line">    model.fit(X_train_scaled, y_train)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 预测</span></span><br><span class="line">    y_pred = model.predict(X_test_scaled)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 评估</span></span><br><span class="line">    accuracy = model.score(X_test_scaled, y_test)</span><br><span class="line">    </span><br><span class="line">    results[name] = &#123;</span><br><span class="line">        <span class="string">&#x27;CV Mean&#x27;</span>: cv_scores.mean(),</span><br><span class="line">        <span class="string">&#x27;CV Std&#x27;</span>: cv_scores.std(),</span><br><span class="line">        <span class="string">&#x27;Test Accuracy&#x27;</span>: accuracy</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;name&#125;</span> 结果:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;交叉验证准确率: <span class="subst">&#123;cv_scores.mean():<span class="number">.3</span>f&#125;</span> (+/- <span class="subst">&#123;cv_scores.std() * <span class="number">2</span>:<span class="number">.3</span>f&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;测试集准确率: <span class="subst">&#123;accuracy:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;分类报告:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(classification_report(y_test, y_pred, target_names=iris.target_names))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 超参数调优</span></span><br><span class="line">param_grid = &#123;</span><br><span class="line">    <span class="string">&#x27;n_estimators&#x27;</span>: [<span class="number">50</span>, <span class="number">100</span>, <span class="number">200</span>],</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="literal">None</span>],</span><br><span class="line">    <span class="string">&#x27;min_samples_split&#x27;</span>: [<span class="number">2</span>, <span class="number">5</span>, <span class="number">10</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rf = RandomForestClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">grid_search = GridSearchCV(rf, param_grid, cv=<span class="number">5</span>, scoring=<span class="string">&#x27;accuracy&#x27;</span>)</span><br><span class="line">grid_search.fit(X_train_scaled, y_train)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n最佳参数: <span class="subst">&#123;grid_search.best_params_&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;最佳交叉验证分数: <span class="subst">&#123;grid_search.best_score_:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-TensorFlow-Keras-深度学习"><a href="#5-TensorFlow-Keras-深度学习" class="headerlink" title="5. TensorFlow&#x2F;Keras - 深度学习"></a>5. TensorFlow&#x2F;Keras - 深度学习</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置随机种子</span></span><br><span class="line">tf.random.set_seed(<span class="number">42</span>)</span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载MNIST数据集</span></span><br><span class="line">(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据预处理</span></span><br><span class="line">x_train = x_train.astype(<span class="string">&#x27;float32&#x27;</span>) / <span class="number">255.0</span></span><br><span class="line">x_test = x_test.astype(<span class="string">&#x27;float32&#x27;</span>) / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建模型</span></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">    layers.Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dropout(<span class="number">0.2</span>),</span><br><span class="line">    layers.Dense(<span class="number">64</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dropout(<span class="number">0.2</span>),</span><br><span class="line">    layers.Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译模型</span></span><br><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>,</span><br><span class="line">    metrics=[<span class="string">&#x27;accuracy&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型摘要</span></span><br><span class="line">model.summary()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练模型</span></span><br><span class="line">history = model.fit(</span><br><span class="line">    x_train, y_train,</span><br><span class="line">    epochs=<span class="number">10</span>,</span><br><span class="line">    batch_size=<span class="number">128</span>,</span><br><span class="line">    validation_split=<span class="number">0.1</span>,</span><br><span class="line">    verbose=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 评估模型</span></span><br><span class="line">test_loss, test_accuracy = model.evaluate(x_test, y_test, verbose=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;测试准确率: <span class="subst">&#123;test_accuracy:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化训练过程</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;accuracy&#x27;</span>], label=<span class="string">&#x27;训练准确率&#x27;</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;val_accuracy&#x27;</span>], label=<span class="string">&#x27;验证准确率&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;模型准确率&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;轮次&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;准确率&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;loss&#x27;</span>], label=<span class="string">&#x27;训练损失&#x27;</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;val_loss&#x27;</span>], label=<span class="string">&#x27;验证损失&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;模型损失&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;轮次&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;损失&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测示例</span></span><br><span class="line">predictions = model.predict(x_test[:<span class="number">5</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    predicted_class = np.argmax(predictions[i])</span><br><span class="line">    actual_class = y_test[i]</span><br><span class="line">    confidence = np.<span class="built_in">max</span>(predictions[i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;样本 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: 预测=<span class="subst">&#123;predicted_class&#125;</span>, 实际=<span class="subst">&#123;actual_class&#125;</span>, 置信度=<span class="subst">&#123;confidence:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="实战项目：房价预测"><a href="#实战项目：房价预测" class="headerlink" title="实战项目：房价预测"></a>实战项目：房价预测</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error, r2_score</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_boston</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：load_boston在新版本中已弃用，这里用于演示</span></span><br><span class="line"><span class="comment"># 实际项目中应使用其他数据集</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成模拟房价数据</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">n_samples = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;area&#x27;</span>: np.random.normal(<span class="number">100</span>, <span class="number">30</span>, n_samples),  <span class="comment"># 面积</span></span><br><span class="line">    <span class="string">&#x27;rooms&#x27;</span>: np.random.randint(<span class="number">1</span>, <span class="number">6</span>, n_samples),   <span class="comment"># 房间数</span></span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: np.random.randint(<span class="number">0</span>, <span class="number">50</span>, n_samples),    <span class="comment"># 房龄</span></span><br><span class="line">    <span class="string">&#x27;distance&#x27;</span>: np.random.exponential(<span class="number">5</span>, n_samples),  <span class="comment"># 距离市中心</span></span><br><span class="line">    <span class="string">&#x27;income&#x27;</span>: np.random.normal(<span class="number">50000</span>, <span class="number">15000</span>, n_samples)  <span class="comment"># 周边收入水平</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成目标变量（房价）</span></span><br><span class="line">data[<span class="string">&#x27;price&#x27;</span>] = (</span><br><span class="line">    data[<span class="string">&#x27;area&#x27;</span>] * <span class="number">500</span> +</span><br><span class="line">    data[<span class="string">&#x27;rooms&#x27;</span>] * <span class="number">10000</span> +</span><br><span class="line">    (<span class="number">50</span> - data[<span class="string">&#x27;age&#x27;</span>]) * <span class="number">200</span> +</span><br><span class="line">    data[<span class="string">&#x27;income&#x27;</span>] * <span class="number">0.5</span> -</span><br><span class="line">    data[<span class="string">&#x27;distance&#x27;</span>] * <span class="number">1000</span> +</span><br><span class="line">    np.random.normal(<span class="number">0</span>, <span class="number">10000</span>, n_samples)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保价格为正数</span></span><br><span class="line">data[<span class="string">&#x27;price&#x27;</span>] = np.maximum(data[<span class="string">&#x27;price&#x27;</span>], <span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数据集信息:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.info())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n描述性统计:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.describe())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据可视化</span></span><br><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">3</span>, figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特征分布</span></span><br><span class="line"><span class="keyword">for</span> i, column <span class="keyword">in</span> <span class="built_in">enumerate</span>(data.columns):</span><br><span class="line">    row = i // <span class="number">3</span></span><br><span class="line">    col = i % <span class="number">3</span></span><br><span class="line">    <span class="keyword">if</span> row &lt; <span class="number">2</span> <span class="keyword">and</span> col &lt; <span class="number">3</span>:</span><br><span class="line">        axes[row, col].hist(data[column], bins=<span class="number">30</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">        axes[row, col].set_title(<span class="string">f&#x27;<span class="subst">&#123;column&#125;</span> 分布&#x27;</span>)</span><br><span class="line">        axes[row, col].set_xlabel(column)</span><br><span class="line">        axes[row, col].set_ylabel(<span class="string">&#x27;频次&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 相关性分析</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">corr_matrix = data.corr()</span><br><span class="line">sns.heatmap(corr_matrix, annot=<span class="literal">True</span>, cmap=<span class="string">&#x27;coolwarm&#x27;</span>, center=<span class="number">0</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;特征相关性热力图&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特征工程</span></span><br><span class="line">X = data.drop(<span class="string">&#x27;price&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">y = data[<span class="string">&#x27;price&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据分割</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特征标准化</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_scaled = scaler.fit_transform(X_train)</span><br><span class="line">X_test_scaled = scaler.transform(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型训练</span></span><br><span class="line">models = &#123;</span><br><span class="line">    <span class="string">&#x27;Linear Regression&#x27;</span>: LinearRegression(),</span><br><span class="line">    <span class="string">&#x27;Random Forest&#x27;</span>: RandomForestRegressor(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">results = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models.items():</span><br><span class="line">    <span class="comment"># 训练模型</span></span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">&#x27;Linear Regression&#x27;</span>:</span><br><span class="line">        model.fit(X_train_scaled, y_train)</span><br><span class="line">        y_pred = model.predict(X_test_scaled)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        model.fit(X_train, y_train)</span><br><span class="line">        y_pred = model.predict(X_test)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 评估模型</span></span><br><span class="line">    mse = mean_squared_error(y_test, y_pred)</span><br><span class="line">    rmse = np.sqrt(mse)</span><br><span class="line">    r2 = r2_score(y_test, y_pred)</span><br><span class="line">    </span><br><span class="line">    results[name] = &#123;</span><br><span class="line">        <span class="string">&#x27;RMSE&#x27;</span>: rmse,</span><br><span class="line">        <span class="string">&#x27;R²&#x27;</span>: r2</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;name&#125;</span> 结果:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;RMSE: <span class="subst">&#123;rmse:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;R²: <span class="subst">&#123;r2:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 预测 vs 实际值图</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">    plt.scatter(y_test, y_pred, alpha=<span class="number">0.5</span>)</span><br><span class="line">    plt.plot([y_test.<span class="built_in">min</span>(), y_test.<span class="built_in">max</span>()], [y_test.<span class="built_in">min</span>(), y_test.<span class="built_in">max</span>()], <span class="string">&#x27;r--&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;实际价格&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;预测价格&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span> - 预测 vs 实际&#x27;</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特征重要性（随机森林）</span></span><br><span class="line">rf_model = models[<span class="string">&#x27;Random Forest&#x27;</span>]</span><br><span class="line">feature_importance = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;feature&#x27;</span>: X.columns,</span><br><span class="line">    <span class="string">&#x27;importance&#x27;</span>: rf_model.feature_importances_</span><br><span class="line">&#125;).sort_values(<span class="string">&#x27;importance&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">sns.barplot(data=feature_importance, x=<span class="string">&#x27;importance&#x27;</span>, y=<span class="string">&#x27;feature&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;特征重要性&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;重要性&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n特征重要性排序:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(feature_importance)</span><br></pre></td></tr></table></figure>

<h2 id="Python-AI开发最佳实践"><a href="#Python-AI开发最佳实践" class="headerlink" title="Python AI开发最佳实践"></a>Python AI开发最佳实践</h2><h3 id="1-代码组织结构"><a href="#1-代码组织结构" class="headerlink" title="1. 代码组织结构"></a>1. 代码组织结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ai_project/</span><br><span class="line">├── data/</span><br><span class="line">│   ├── raw/</span><br><span class="line">│   ├── processed/</span><br><span class="line">│   └── external/</span><br><span class="line">├── notebooks/</span><br><span class="line">│   ├── exploratory/</span><br><span class="line">│   └── experiments/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── data/</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── preprocessing.py</span><br><span class="line">│   ├── models/</span><br><span class="line">│   │   ├── __init__.py</span><br><span class="line">│   │   └── train_model.py</span><br><span class="line">│   └── visualization/</span><br><span class="line">│       ├── __init__.py</span><br><span class="line">│       └── visualize.py</span><br><span class="line">├── tests/</span><br><span class="line">├── requirements.txt</span><br><span class="line">├── setup.py</span><br><span class="line">└── README.md</span><br></pre></td></tr></table></figure>

<h3 id="2-配置管理"><a href="#2-配置管理" class="headerlink" title="2. 配置管理"></a>2. 配置管理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Config</span>:</span><br><span class="line">    <span class="comment"># 数据路径</span></span><br><span class="line">    DATA_DIR: <span class="built_in">str</span> = <span class="string">&quot;data/&quot;</span></span><br><span class="line">    RAW_DATA_DIR: <span class="built_in">str</span> = os.path.join(DATA_DIR, <span class="string">&quot;raw&quot;</span>)</span><br><span class="line">    PROCESSED_DATA_DIR: <span class="built_in">str</span> = os.path.join(DATA_DIR, <span class="string">&quot;processed&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 模型参数</span></span><br><span class="line">    RANDOM_STATE: <span class="built_in">int</span> = <span class="number">42</span></span><br><span class="line">    TEST_SIZE: <span class="built_in">float</span> = <span class="number">0.2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 训练参数</span></span><br><span class="line">    BATCH_SIZE: <span class="built_in">int</span> = <span class="number">32</span></span><br><span class="line">    EPOCHS: <span class="built_in">int</span> = <span class="number">100</span></span><br><span class="line">    LEARNING_RATE: <span class="built_in">float</span> = <span class="number">0.001</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 模型保存</span></span><br><span class="line">    MODEL_DIR: <span class="built_in">str</span> = <span class="string">&quot;models/&quot;</span></span><br><span class="line">    </span><br><span class="line">config = Config()</span><br></pre></td></tr></table></figure>

<h3 id="3-日志记录"><a href="#3-日志记录" class="headerlink" title="3. 日志记录"></a>3. 日志记录</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_logger</span>(<span class="params">name, log_file, level=logging.INFO</span>):</span><br><span class="line">    formatter = logging.Formatter(</span><br><span class="line">        <span class="string">&#x27;%(asctime)s %(levelname)s %(name)s: %(message)s&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    handler = logging.FileHandler(log_file)</span><br><span class="line">    handler.setFormatter(formatter)</span><br><span class="line">    </span><br><span class="line">    logger = logging.getLogger(name)</span><br><span class="line">    logger.setLevel(level)</span><br><span class="line">    logger.addHandler(handler)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> logger</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">logger = setup_logger(<span class="string">&#x27;ai_project&#x27;</span>, <span class="string">&#x27;logs/training.log&#x27;</span>)</span><br><span class="line">logger.info(<span class="string">&#x27;开始训练模型&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="4-单元测试"><a href="#4-单元测试" class="headerlink" title="4. 单元测试"></a>4. 单元测试</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tests/test_preprocessing.py</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> src.data.preprocessing <span class="keyword">import</span> clean_data, normalize_features</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestPreprocessing</span>(unittest.TestCase):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.sample_data = pd.DataFrame(&#123;</span><br><span class="line">            <span class="string">&#x27;feature1&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">            <span class="string">&#x27;feature2&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>],</span><br><span class="line">            <span class="string">&#x27;target&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_clean_data</span>(<span class="params">self</span>):</span><br><span class="line">        cleaned = clean_data(<span class="variable language_">self</span>.sample_data)</span><br><span class="line">        <span class="variable language_">self</span>.assertFalse(cleaned.isnull().<span class="built_in">any</span>().<span class="built_in">any</span>())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_normalize_features</span>(<span class="params">self</span>):</span><br><span class="line">        normalized = normalize_features(<span class="variable language_">self</span>.sample_data[[<span class="string">&#x27;feature1&#x27;</span>, <span class="string">&#x27;feature2&#x27;</span>]])</span><br><span class="line">        <span class="variable language_">self</span>.assertAlmostEqual(normalized.mean().mean(), <span class="number">0</span>, places=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>

<h3 id="5-版本控制和依赖管理"><a href="#5-版本控制和依赖管理" class="headerlink" title="5. 版本控制和依赖管理"></a>5. 版本控制和依赖管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># requirements.txt</span></span><br><span class="line">numpy==1.21.0</span><br><span class="line">pandas==1.3.0</span><br><span class="line">scikit-learn==1.0.0</span><br><span class="line">tensorflow==2.6.0</span><br><span class="line">matplotlib==3.4.0</span><br><span class="line">seaborn==0.11.0</span><br><span class="line">jupyter==1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用conda environment.yml</span></span><br><span class="line">name: ai_env</span><br><span class="line">channels:</span><br><span class="line">  - conda-forge</span><br><span class="line">  - defaults</span><br><span class="line">dependencies:</span><br><span class="line">  - python=3.9</span><br><span class="line">  - numpy</span><br><span class="line">  - pandas</span><br><span class="line">  - scikit-learn</span><br><span class="line">  - matplotlib</span><br><span class="line">  - seaborn</span><br><span class="line">  - jupyter</span><br><span class="line">  - pip</span><br><span class="line">  - pip:</span><br><span class="line">    - tensorflow</span><br><span class="line">    - torch</span><br></pre></td></tr></table></figure>

<h2 id="性能优化技巧"><a href="#性能优化技巧" class="headerlink" title="性能优化技巧"></a>性能优化技巧</h2><h3 id="1-NumPy优化"><a href="#1-NumPy优化" class="headerlink" title="1. NumPy优化"></a>1. NumPy优化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 避免循环，使用向量化操作</span></span><br><span class="line">n = <span class="number">1000000</span></span><br><span class="line">a = np.random.randn(n)</span><br><span class="line">b = np.random.randn(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 慢速方法（循环）</span></span><br><span class="line">start_time = time.time()</span><br><span class="line">result_slow = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    result_slow.append(a[i] * b[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;循环方法耗时: <span class="subst">&#123;time.time() - start_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 快速方法（向量化）</span></span><br><span class="line">start_time = time.time()</span><br><span class="line">result_fast = a * b</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;向量化方法耗时: <span class="subst">&#123;time.time() - start_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-Pandas优化"><a href="#2-Pandas优化" class="headerlink" title="2. Pandas优化"></a>2. Pandas优化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用适当的数据类型</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;int_col&#x27;</span>: np.random.randint(<span class="number">0</span>, <span class="number">100</span>, <span class="number">10000</span>),</span><br><span class="line">    <span class="string">&#x27;float_col&#x27;</span>: np.random.randn(<span class="number">10000</span>),</span><br><span class="line">    <span class="string">&#x27;cat_col&#x27;</span>: np.random.choice([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>], <span class="number">10000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 优化内存使用</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;优化前内存使用: <span class="subst">&#123;df.memory_usage(deep=<span class="literal">True</span>).<span class="built_in">sum</span>()&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为更小的数据类型</span></span><br><span class="line">df[<span class="string">&#x27;int_col&#x27;</span>] = df[<span class="string">&#x27;int_col&#x27;</span>].astype(<span class="string">&#x27;int8&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;float_col&#x27;</span>] = df[<span class="string">&#x27;float_col&#x27;</span>].astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;cat_col&#x27;</span>] = df[<span class="string">&#x27;cat_col&#x27;</span>].astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;优化后内存使用: <span class="subst">&#123;df.memory_usage(deep=<span class="literal">True</span>).<span class="built_in">sum</span>()&#125;</span> bytes&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-并行处理"><a href="#3-并行处理" class="headerlink" title="3. 并行处理"></a>3. 并行处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_square</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 串行处理</span></span><br><span class="line">data = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1000000</span>))</span><br><span class="line">start_time = time.time()</span><br><span class="line">result_serial = [compute_square(x) <span class="keyword">for</span> x <span class="keyword">in</span> data]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;串行处理耗时: <span class="subst">&#123;time.time() - start_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 并行处理</span></span><br><span class="line">start_time = time.time()</span><br><span class="line"><span class="keyword">with</span> Pool() <span class="keyword">as</span> pool:</span><br><span class="line">    result_parallel = pool.<span class="built_in">map</span>(compute_square, data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;并行处理耗时: <span class="subst">&#123;time.time() - start_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="学习资源推荐"><a href="#学习资源推荐" class="headerlink" title="学习资源推荐"></a>学习资源推荐</h2><h3 id="1-官方文档"><a href="#1-官方文档" class="headerlink" title="1. 官方文档"></a>1. 官方文档</h3><ul>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/">Python官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://numpy.org/doc/">NumPy文档</a></li>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/">Pandas文档</a></li>
<li><a target="_blank" rel="noopener" href="https://scikit-learn.org/stable/">Scikit-learn文档</a></li>
<li><a target="_blank" rel="noopener" href="https://www.tensorflow.org/">TensorFlow文档</a></li>
</ul>
<h3 id="2-在线课程"><a href="#2-在线课程" class="headerlink" title="2. 在线课程"></a>2. 在线课程</h3><ul>
<li>Python for Everybody (Coursera)</li>
<li>Python Data Science Handbook</li>
<li>Fast.ai Practical Deep Learning</li>
</ul>
<h3 id="3-书籍推荐"><a href="#3-书籍推荐" class="headerlink" title="3. 书籍推荐"></a>3. 书籍推荐</h3><ul>
<li>《Python编程：从入门到实践》</li>
<li>《利用Python进行数据分析》</li>
<li>《Python机器学习》</li>
<li>《深度学习入门：基于Python的理论与实现》</li>
</ul>
<h3 id="4-实践平台"><a href="#4-实践平台" class="headerlink" title="4. 实践平台"></a>4. 实践平台</h3><ul>
<li>Kaggle：数据科学竞赛</li>
<li>Google Colab：免费GPU环境</li>
<li>Jupyter Notebook：交互式开发</li>
<li>GitHub：开源项目学习</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Python在人工智能领域的优势：</p>
<ol>
<li><strong>易学易用</strong>：简洁的语法，快速上手</li>
<li><strong>生态丰富</strong>：完整的AI开发工具链</li>
<li><strong>社区活跃</strong>：丰富的学习资源和技术支持</li>
<li><strong>跨平台</strong>：支持多种操作系统</li>
<li><strong>开源免费</strong>：降低学习和开发成本</li>
</ol>
<p>掌握Python AI开发的关键：</p>
<ul>
<li>熟练使用核心库（NumPy、Pandas、Scikit-learn等）</li>
<li>理解数据处理和机器学习流程</li>
<li>养成良好的编程习惯</li>
<li>持续学习新技术和最佳实践</li>
</ul>
<p>通过系统学习和大量实践，你将能够运用Python解决各种AI问题，从数据分析到深度学习模型开发。</p>
<hr>
<p><em>下一篇文章我们将探讨计算机视觉的基础知识和OpenCV的使用，敬请期待！</em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://langxin772.github.io/2025/01/03/python-for-ai/" data-id="cmbrvlui8000lrwl89hl2gnaz" data-title="Python在人工智能中的应用：从入门到实战" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Wzyqcsj.github.io/tags/AI%E5%B7%A5%E5%85%B7/" rel="tag">AI工具</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Wzyqcsj.github.io/tags/Python/" rel="tag">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Wzyqcsj.github.io/tags/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/" rel="tag">数据科学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Wzyqcsj.github.io/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/Wzyqcsj.github.io/2025/01/04/deep-learning-guide/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          深度学习入门：神经网络的奥秘
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/Wzyqcsj.github.io/categories/AI%E5%9F%BA%E7%A1%80/">AI基础</a></li><li class="category-list-item"><a class="category-list-link" href="/Wzyqcsj.github.io/categories/%E6%8A%80%E6%9C%AF%E6%95%99%E7%A8%8B/">技术教程</a></li><li class="category-list-item"><a class="category-list-link" href="/Wzyqcsj.github.io/categories/%E7%BC%96%E7%A8%8B%E6%95%99%E7%A8%8B/">编程教程</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/AI%E5%B7%A5%E5%85%B7/" rel="tag">AI工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/PyTorch/" rel="tag">PyTorch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/TensorFlow/" rel="tag">TensorFlow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E4%B8%93%E4%B8%9A%E4%BB%8B%E7%BB%8D/" rel="tag">专业介绍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97/" rel="tag">学习指南</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/" rel="tag">数据科学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" rel="tag">神经网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Wzyqcsj.github.io/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/Wzyqcsj.github.io/tags/AI%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">AI工具</a> <a href="/Wzyqcsj.github.io/tags/PyTorch/" style="font-size: 10px;">PyTorch</a> <a href="/Wzyqcsj.github.io/tags/Python/" style="font-size: 20px;">Python</a> <a href="/Wzyqcsj.github.io/tags/TensorFlow/" style="font-size: 10px;">TensorFlow</a> <a href="/Wzyqcsj.github.io/tags/%E4%B8%93%E4%B8%9A%E4%BB%8B%E7%BB%8D/" style="font-size: 10px;">专业介绍</a> <a href="/Wzyqcsj.github.io/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/Wzyqcsj.github.io/tags/%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97/" style="font-size: 10px;">学习指南</a> <a href="/Wzyqcsj.github.io/tags/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/" style="font-size: 20px;">数据科学</a> <a href="/Wzyqcsj.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">机器学习</a> <a href="/Wzyqcsj.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">深度学习</a> <a href="/Wzyqcsj.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">神经网络</a> <a href="/Wzyqcsj.github.io/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/Wzyqcsj.github.io/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">编程</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/Wzyqcsj.github.io/archives/2025/01/">一月 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/Wzyqcsj.github.io/2025/01/06/ai-introduction/">人工智能专业学习指南</a>
          </li>
        
          <li>
            <a href="/Wzyqcsj.github.io/2025/01/05/machine-learning-basics/">机器学习基础：从零开始的完整指南</a>
          </li>
        
          <li>
            <a href="/Wzyqcsj.github.io/2025/01/04/deep-learning-guide/">深度学习入门：神经网络的奥秘</a>
          </li>
        
          <li>
            <a href="/Wzyqcsj.github.io/2025/01/03/python-for-ai/">Python在人工智能中的应用：从入门到实战</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 AI学习者<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/Wzyqcsj.github.io/" class="mobile-nav-link">Home</a>
  
    <a href="/Wzyqcsj.github.io/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/Wzyqcsj.github.io/js/jquery-3.6.4.min.js"></script>



  
<script src="/Wzyqcsj.github.io/fancybox/jquery.fancybox.min.js"></script>




<script src="/Wzyqcsj.github.io/js/script.js"></script>





  </div>
</body>
</html>